{
  "version": 3,
  "file": "alyle-ui-ls.js",
  "sources": [
    "ng://@alyle/ui/ls/out/ls.module.ts",
    "ng://@alyle/ui/ls/out/minimal-localstorage.ts"
  ],
  "sourcesContent": [
    "import {\n  NgModule, ModuleWithProviders,\n  ViewContainerRef, SkipSelf, Optional,\n  InjectionToken }                       from '@angular/core';\nimport { MinimalLS } from './minimal-localstorage';\n\n@NgModule({\n  providers: [\n    MinimalLS\n  ]\n})\nexport class MinimalLSModule { }\n",
    "import {\n  NgModule,\n  ModuleWithProviders,\n  ElementRef,\n  ViewContainerRef,\n  Injectable,\n  Inject\n}                          from '@angular/core';\nimport { PLATFORM_ID } from '@angular/core';\nimport { isPlatformBrowser, isPlatformServer } from '@angular/common';\nimport { Observable ,  Subject ,  BehaviorSubject ,  Observer ,  fromEvent }      from 'rxjs';\nimport { CommonModule }    from '@angular/common';\n\nexport class MinimalStorage {\n  constructor(key$: string, val: any) {\n    localStorage.setItem(key$, JSON.stringify(val));\n  }\n}\n\n@Injectable()\nexport class MinimalLS {\n  private itemsSubject = new Map<string, BehaviorSubject<string>>();\n  private _prefix = '*ls*';\n  private storageEvent: Observable<any>;\n  private storage = new Subject();\n  private storageObservable: Observable<any>;\n  constructor(@Inject(PLATFORM_ID) private platformId: Object) {\n    if (isPlatformBrowser(this.platformId)) {\n      this.storageEvent = fromEvent(window, 'storage');\n      this.storageEvent.subscribe((e) => {\n        this.storage.next({\n          key: e.key,\n          value: e.newValue\n        });\n      });\n      this.storageObservable = this.storage.asObservable();\n    }\n  }\n\n  /**\n   * get boolean\n   */\n  hasItem(key$: string): boolean {\n    const key = this._addPrefix(key$);\n    if (isPlatformBrowser(this.platformId)) {\n      return !!localStorage.getItem(key);\n    }\n    if (isPlatformServer(this.platformId)) {\n      return false;\n    }\n  }\n  /**\n   * Set new item or replace item\n   */\n  setItem(key$: string, val: any, _storage = true) {\n    const key = this._addPrefix(key$);\n    if (_storage) {\n      if (isPlatformBrowser(this.platformId)) {\n        // tslint:disable-next-line:no-unused-expression\n        new MinimalStorage(key, val);\n      }\n    }\n    this.storage.next({\n      key: key,\n      value: this.item(key$)\n    });\n    // this.itemsSubject.set(key, new BehaviorSubject<string>(val));\n  }\n  /**\n   * Get Observable from localStorage\n   */\n  getItem(key$: string, before?: any): Observable<any> {\n    const key = this._addPrefix(key$);\n    const ob = new Observable((observer) => {\n      if (this.hasItem(key$)) {\n        observer.next(this.item(key$));\n      }\n      this.storageObservable.subscribe((e) => {\n        if (key === e.key) {\n          observer.next(e.value);\n        }\n      });\n    });\n    return ob;\n  }\n  /**\n   * Get value from localstorage\n   */\n  item(key$: string): any {\n    const key = this._addPrefix(key$);\n    try {\n      return JSON.parse(window.localStorage[key]);\n    } catch (e) {\n      return null;\n    }\n  }\n\n  private _addPrefix(val) {\n    return `{\"${this._prefix}\":\"${val}\"}`;\n  }\n  private _removePrefix(val) {\n    try {\n      return JSON.parse(val)[this._prefix];\n    } catch (e) {\n      return null;\n    }\n  }\n}\n\n"
  ],
  "names": [],
  "mappings": "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"
}
